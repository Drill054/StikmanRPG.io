<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mini RPG Android Realistis</title>
<style>
  body { margin:0; overflow:hidden; background:#000; }
  #gameCanvas { display:block; margin:0 auto; background:#87ceeb; }
  .controls {
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    display: grid;
    grid-template-columns: repeat(3, 60px);
    grid-template-rows: repeat(2, 60px);
    gap: 10px;
  }
  .btn {
    width:60px; height:60px;
    background: rgba(255,255,255,0.5);
    border-radius:10px;
    display:flex; align-items:center; justify-content:center;
    font-size:24px; user-select:none; touch-action:none;
  }
  .empty { background: transparent; }
  #dialog {
    position: fixed; bottom: 100px; left:50%; transform: translateX(-50%);
    padding:10px 20px; background: rgba(0,0,0,0.7); color:#fff;
    font-family:sans-serif; font-size:16px; border-radius:10px; display:none;
  }
</style>
</head>
<body>
<canvas id="gameCanvas" width="480" height="320"></canvas>

<div class="controls">
  <div class="empty"></div>
  <div class="btn" id="up">↑</div>
  <div class="empty"></div>
  <div class="btn" id="left">←</div>
  <div class="btn" id="down">↓</div>
  <div class="btn" id="right">→</div>
</div>

<div id="dialog">Hello! Aku NPC!</div>

<script>
// Canvas
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

// Tile & peta
const tileSize = 64;
const mapWidth = 8;
const mapHeight = 5;
const map = [
  [0,0,0,0,0,0,0,0],
  [0,1,1,0,0,1,0,0],
  [0,0,0,0,1,0,0,0],
  [0,1,0,0,0,0,1,0],
  [0,0,0,1,0,0,0,0]
];

// Load gambar
const images = {};
function loadImages(sources, callback){
  let loaded = 0;
  const keys = Object.keys(sources);
  keys.forEach(key => {
    images[key] = new Image();
    images[key].src = sources[key];
    images[key].onload = ()=> {
      loaded++;
      if(loaded === keys.length) callback();
    }
  });
}

// Sumber gambar (bisa diganti dengan sprite sendiri)
const sources = {
  player: 'https://i.ibb.co/XYK5z9s/player.png', // contoh sprite pemain
  npc: 'https://i.ibb.co/2M8rPRV/npc.png',       // contoh sprite NPC
  grass: 'https://i.ibb.co/3Wq5JzH/grass.png',   // tile grass
  tree: 'https://i.ibb.co/6t8Lw1f/tree.png'      // tile tree
};

// Karakter & NPC
const player = { x:1, y:1 };
const npc = { x:5, y:2 };

// Tombol sentuh
const keys = { up:false, down:false, left:false, right:false };
['up','down','left','right'].forEach(dir=>{
  const btn=document.getElementById(dir);
  btn.addEventListener('touchstart',()=>keys[dir]=true);
  btn.addEventListener('touchend',()=>keys[dir]=false);
});

const dialog = document.getElementById('dialog');

function drawMap(){
  for(let y=0;y<map.length;y++){
    for(let x=0;x<map[y].length;x++){
      const tile = map[y][x]===0 ? images.grass : images.tree;
      ctx.drawImage(tile, x*tileSize, y*tileSize, tileSize, tileSize);
    }
  }
}

function drawCharacter(char, img){
  ctx.drawImage(img, char.x*tileSize, char.y*tileSize, tileSize, tileSize);
}

function movePlayer(){
  if(keys.up && map[player.y-1]?.[player.x]===0) player.y--;
  if(keys.down && map[player.y+1]?.[player.x]===0) player.y++;
  if(keys.left && map[player.y]?.[player.x-1]===0) player.x--;
  if(keys.right && map[player.y]?.[player.x+1]===0) player.x++;
}

function checkNPC(){
  if(player.x===npc.x && player.y===npc.y) dialog.style.display='block';
  else dialog.style.display='none';
}

function gameLoop(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  drawMap();
  drawCharacter(npc, images.npc);
  movePlayer();
  drawCharacter(player, images.player);
  checkNPC();
  requestAnimationFrame(gameLoop);
}

// Load gambar dulu
loadImages(sources, ()=>{
  gameLoop();
});
</script>
</body>
</html>
